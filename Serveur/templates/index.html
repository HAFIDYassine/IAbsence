<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Data in HTML Table</title>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>

</head>
<body>
    <script>
        let d = new Date();
        let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        let formattedDate = d.toLocaleDateString('fr-FR', options);
        document.body.innerHTML = "<h1> liste de présence du " + formattedDate + "</h1>"
    </script>
    <table border="1">
        <thead>
            <tr>
                <th>{{ headings[0] }}</th>
                <th>{{ headings[1] }}</th>
            </tr>
        </thead>
        <tbody id="table-body">
            {% for item in mydata %}
            <tr>
                <td>{{ item.nom_etudiant }}</td>
                <td>{{ item['heure arrivé'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
     <button id="download-pdf">Download PDF</button>

     <script>
         document.getElementById('download-pdf').addEventListener('click', function () {
             console.log('Button clicked');
             var doc = new jsPDF();
             
              
             var titleText = "Liste de présence du " + formattedDate;

             
             var textWidth = doc.getStringUnitWidth(titleText) * doc.internal.getFontSize() / doc.internal.scaleFactor;
                
             var xOffset = (doc.internal.pageSize.width - textWidth) / 2;

               
             doc.text(titleText, xOffset, 10);
             
             //doc.text("liste de présence du " + formattedDate, 5, 10);
             doc.autoTable({ html: 'table' });
             doc.save('table.pdf');
         });
     </script>

     
     <script>
        setInterval(function() {
            location.reload();
        }, 60000); 
    </script>
</body>
</html>